<center>
  
# «Метод наименьших квадратов»  
## Описание модели
</center>

Модель полезного сигнала имеет вид:

$$\phi(x) = \theta_0 + \theta_1 x + \ldots + \theta_m x^m.(1)$$ 

Рассматривается модель наблюдений:
$$y_k = \theta_0 + \theta_1 x_k + \ldots + \theta_m x_k^m + \varepsilon_k, \quad k=\overline{1, n}, (2)$$
где $\varepsilon_1, \ldots, \varepsilon_n$  – независимые центрированные и одинаково распределённые случайные величины.
<center>

## Моделирование данных
Смоделировать два набора наблюдений на основе модели (2) для следующих случаев:

<table align="center">
    <tr>
        <th>Первый случай</th>
        <th>Второй случай</th>
    </tr>
    <tr>
        <td>$$m=3, \varepsilon_k \sim N(0, \sigma^2)$$</td>
        <td>$$m=2, \varepsilon_k \sim R(-3\sigma, 3\sigma) $$</td>
    </tr>
    <tr>
        <td>$$x_k=-4+k\frac{8}{n},$$</td>
        <td>$$\qquad k = \overline{1,n} , \qquad n=40$$</td>
    </tr>
</table> 

$$\theta_0 = -21, \theta_1 = -3, \theta_2 = -6, \theta_3 = 0.11, \sigma^2 = 3.0$$

## Задание
Для обоих случаев выполнить по очереди следующие задания.
1. Подобрать порядок многочлена $\hat{m}$ в модели (1), используя критерий Фишера на уровне значимости 0.05, и вычислить оценки неизвестных параметров $(\theta_0, \ldots, \theta_{\hat{m}})$ методом наименьших квадратов.
2. В предположении нормальности ошибок построить доверительные интервалы уровней
надёжности $\alpha_1 = 0.95$ и $\alpha_2 = 0.99$ для параметров $(\theta_0, \ldots, \theta_{\hat{m}})$.
3. В предположении нормальности ошибок построить доверительные интервалы уровней.
надёжности $\alpha_1 = 0.95$ и $\alpha_2 = 0.99$ для полезного сигнала (1).
4. Представить графически
> - истинный полезный сигнал,
> - набор наблюдений,
> - оценку полезного сигнала, полученную в шаге 1,
> - доверительные интервалы полезного сигнала, полученные в шаге 3.

5. По остаткам регрессии построить оценку плотности распределения случайной ошибки
наблюдения в виде гистограммы.
6. В предположении нормальности ошибок вычислить оценку максимального правдоподобия
дисперсии $\sigma^2$ случайной ошибки.
7. По остаткам регрессии с помощью &chi;² критерия Пирсона на уровне значимости 0.05 проверить
гипотезу о том, что закон распределения ошибки наблюдения является нормальным.

## Описание

Одной из важнейших деталей, отличающих оба случая, является вектор ошибок $\overline{ε}$, соответствующий следующим значениям с точностью до
третьего знака после запятой для первого случая:\
[ 2.118, -0.798, -0.689, -1.399,  1.128, -3.001,  2.275, -0.992,
        0.416, -0.325,  1.906, -2.686, -0.42 , -0.501,  1.478, -1.434,
       -0.225, -1.145,  0.055,  0.76 , -1.435,  1.493,  1.176,  0.655,
        1.175, -0.891, -0.16 , -1.22 , -0.349,  0.691, -0.902, -0.517,
       -0.896, -1.102, -0.875, -0.017, -1.457,  0.306,  2.164,  0.968]

### 1. Критерий Фишера

Критерий Фишера [1] применяется на модели Zn = Xnθ + E, где E ∼
N (0; σIn) и матрица Xn имеет ранг p, для проверки гипотезы вида H0 :
Aθ = c с помощью реализации статистики

$F(Z_{n}$)= $\frac{(A\widehat{\theta_{n}-c)^{T}[A(X_{n}^{T}X_{n})^{-1}A^{T}]^{-1}(A\widehat{\theta_{n}-c)}{\frac{q}{n-p}(Z_{n}-X_{n}\theta_{n})T(Z_{n}-X_{n}\theta_{n})}$ 


В нашем случае гипотеза формулируется так: «При повышения порядка аппроксимации $\widehat{m}$ модели избыточно ли наличие коэф. $\theta_{\widehat{m}}$ при $x^{\widehat{m}}$ ?» или более формально $H_{0}: \theta_{\widehat{m}}=0$. Формулу можем упростить до $q=$ $1^{1}, p=\widehat{m}+1$ и перейти к скалярному виду, приняв за $k$-ый элемент главной диагонали матрицы $\left(X_{n}^{T} X_{n}\right)^{-1}$ символ $r_{k}$ и вектор остатков за $\widehat{E}=Z_{n}-X_{n} \widehat{\theta}_{n}=Y-X \widehat{\theta}$ :

$$
F\left(Z_{n}\right)=\frac{\widehat{\theta}_{\widehat{m}}^{2}}{r_{\widehat{m}}\|\widehat{E}\|^{2}} \cdot \frac{n-p}{1}
$$

Далее, определив теоретические квантили для заданного уровня значимости $\alpha=0.05$ для распределений Фишера $F(q, n-p)$, проверим, попадает ли значение в критическую область $\left(f_{1-\alpha}(1, n-p) ; \infty\right)$.


